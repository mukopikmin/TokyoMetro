<h2>Exit list</h2>
<table>
  <tr>
  <% for i in 0 .. @exits.length - 1 %>
    <td>
        <a href="/<%= @station["owl:sameAs"].split(':')[1] %>/<%= @exits[i]["dc:title"] %>"><%= @exits[i]["dc:title"] %></a>
      </td>
      <% if ((i + 1) % 3) == 0 %>
        </tr><tr>
      <% end %>
    <% end %>
  </tr>
</table>

<div id="map_canvas"></div>

<script type="text/javascript">
  function initialize() {
    var myOptions = {
      zoom: 17,
      center: new google.maps.LatLng(<%= @station["geo:lat"] %>, <%= @station["geo:long"] %>),
      mapTypeId: google.maps.MapTypeId.ROADMAP
      };
    var map = new google.maps.Map(document.getElementById("map_canvas"),myOptions);
    var markers = [
        <% @exits.each do |e| %>
          ['<%= e["dc:title"] %>', <%= e["geo:lat"] %>, <%= e["geo:long"] %>],
        <% end %>
        ];
    for (var i = 0; i < markers.length; i++) {
      var name = markers[i][0];
      var latlng = new google.maps.LatLng(markers[i][1],markers[i][2]);
      createMarker(name,latlng,map);
      }
  }

  function createMarker(name,latlng,map){
    var infoWindow = new google.maps.InfoWindow();
    var marker = new google.maps.Marker({position: latlng,map: map});
    google.maps.event.addListener(marker, 'click', function() {
        infoWindow.setContent(name);
        infoWindow.open(map,marker);   
        });
  }

  google.maps.event.addDomListener(window, 'load', initialize);
</script>